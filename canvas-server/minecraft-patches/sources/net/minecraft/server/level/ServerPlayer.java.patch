--- a/net/minecraft/server/level/ServerPlayer.java
+++ b/net/minecraft/server/level/ServerPlayer.java
@@ -1565,6 +_,7 @@
         }
         // must be manually removed from connections, delay until after reset() so that we do not trip any thread checks
         this.level().getCurrentWorldData().connections.remove(this.connection.connection);
+        this.level().getCurrentWorldData().waypointManager.removePlayer(this); // Canvas - region threading - restore waypoints
 
         ca.spottedleaf.concurrentutil.completable.CallbackCompletable<org.bukkit.Location> spawnPosComplete =
             new ca.spottedleaf.concurrentutil.completable.CallbackCompletable<>();
@@ -1676,6 +_,7 @@
     protected ServerPlayer transformForAsyncTeleport(ServerLevel destination, Vec3 pos, Float yaw, Float pitch, Vec3 velocity) {
         // must be manually removed from connections
         this.level().getCurrentWorldData().connections.remove(this.connection.connection);
+        this.level().getCurrentWorldData().waypointManager.removePlayer(this); // Canvas - region threading - restore waypoints
         this.level().removePlayerImmediately(this, Entity.RemovalReason.CHANGED_DIMENSION);
 
         this.spawnIn(destination);
@@ -1698,6 +_,7 @@
 
             // must be manually added to connections
             this.level().getCurrentWorldData().connections.add(this.connection.connection);
+            this.level().getCurrentWorldData().waypointManager.addPlayer(this); // Canvas - region threading - restore waypoints
 
             // required to set up the pending teleport stuff to the client, and to actually update
             // the player's position clientside
@@ -1751,6 +_,7 @@
 
             // must be manually added to connections
             this.level().getCurrentWorldData().connections.add(this.connection.connection);
+            this.level().getCurrentWorldData().waypointManager.addPlayer(this); // Canvas - region threading - restore waypoints
 
             // required to set up the pending teleport stuff to the client, and to actually update
             // the player's position clientside
