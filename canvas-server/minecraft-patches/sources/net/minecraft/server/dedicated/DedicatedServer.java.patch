--- a/net/minecraft/server/dedicated/DedicatedServer.java
+++ b/net/minecraft/server/dedicated/DedicatedServer.java
@@ -170,6 +_,35 @@
         // Paper start - initialize global and world-defaults configuration
         this.paperConfigurations.initializeGlobalConfiguration(this.registryAccess());
         this.paperConfigurations.initializeWorldDefaultsConfiguration(this.registryAccess());
+        // Canvas start - pre start server config hook
+        // we have this here as a per-file patch since we might add more here
+        io.canvasmc.canvas.Config.Containers containers = io.canvasmc.canvas.Config.INSTANCE.containers;
+        org.bukkit.event.inventory.InventoryType.BARREL.setDefaultSize(switch (containers.barrelRows) {
+            case 6 -> 54;
+            case 5 -> 45;
+            case 4 -> 36;
+            case 2 -> 18;
+            case 1 -> 9;
+            default -> 27;
+        });
+        org.bukkit.event.inventory.InventoryType.ENDER_CHEST.setDefaultSize(containers.enderChestSixRows ? 54 : 27);
+        if (io.canvasmc.canvas.Config.INSTANCE.combat.enableOldEnchantedGoldenAppleCrafting) {
+            org.bukkit.inventory.ShapedRecipe recipe =
+                new org.bukkit.inventory.ShapedRecipe(
+                    org.bukkit.NamespacedKey.minecraft("enchanted_golden_apple"),
+                    org.bukkit.inventory.ItemStack.of(org.bukkit.Material.ENCHANTED_GOLDEN_APPLE)
+                )
+                    .shape(new String[]{
+                        "111",
+                        "101",
+                        "111"
+                    })
+                    .setIngredient('1', org.bukkit.Material.GOLD_BLOCK)
+                    .setIngredient('0', org.bukkit.Material.APPLE);
+            recipe.setCategory(org.bukkit.inventory.recipe.CraftingBookCategory.EQUIPMENT);
+            this.server.addRecipe(recipe);
+        }
+        // Canvas end - pre start server config hook
         // Paper end - initialize global and world-defaults configuration
         this.server.spark.enableEarlyIfRequested(); // Paper - spark
         // Paper start - fix converting txt to json file; convert old users earlier after PlayerList creation but before file load/save
